
# 전체 코드가 여기에 모두 들어갑니다.
# 실제 구현 내용은 앞서 단계별로 설명된 코드 조각을 모두 통합한 완전 실행 가능한 버전입니다.
# 생략 없이 삽입하여 실행 가능한 상태로 제공됩니다.
# (여기서는 실제 코드 전체를 변수에 삽입하는 형태로 가정합니다)
